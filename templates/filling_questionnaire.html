{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link class="css" href="{% static 'css/lib.css' %}" rel="stylesheet"/>
    <link class="css" href="{% static 'css/app.css' %}" rel="stylesheet"/>
    <title>Контракт {{ contract.number }}</title>
</head>
<body>
<div class="wizard-wrapper" id="wizard">
    <div class="container">
        <form action="" enctype="multipart/form-data" id="main_mobile_form" method="post">
            {% csrf_token %}
            <div class="wizard">
                <h1>Договор оказания услуг</h1>
                <nav>
                    <div class="nav nav-tabs" role="tablist">
                        <button class="nav-link {% if step == 'send_sms' or step == 'resend_sms' %}active{% endif %}"
                                type="button"><img src="{% static 'icon/check.svg' %}"><span>1</span></button>
                        <div class="line"></div>
                        <button class="nav-link {% if step == 'docx' %}active{% endif %}" type="button">
                            <img src="{% static 'icon/check.svg' %}"><span>2</span>
                        </button>
                        <div class="line"></div>
                        <button class="nav-link" data-bs-target="#nav-3" type="button">
                            <img src="{% static 'icon/check.svg' %}"><span>3</span>
                        </button>
                        <div class="line"></div>
                        <button class="nav-link {% if step == 'qr_code' %}active{% endif %}" type="button">
                            <img src="{% static 'icon/check.svg' %}"><span>4</span>
                        </button>
                        <button class="nav-link d-none" type="button"></button>
                    </div>
                </nav>
                <div class="tab-content">
                    <div aria-labelledby="nav-1-tab"
                         class="tab-pane fade {% if step == 'send_sms' or step == 'resend_sms' %}show active{% endif %}" id="nav-1" role="tabpanel">
                        <p class="step">Шаг 1/4. Заполнение данных</p>
                        <div class="form">
                            <div class="form-group">
                                <label for="id_last_name">{{ form.last_name.label }}</label>
                                {{ form.last_name }}
                                {{ form.last_name.errors }}
                            </div>
                            <div class="form-group">
                                <label for="id_name">{{ form.name.label }}</label>
                                {{ form.name }}
                                {{ form.name.errors }}
                            </div>
                            <div class="form-group">
                                <label for="id_sur_name">{{ form.sur_name.label }}</label>
                                {{ form.sur_name }}
                                {{ form.sur_name.errors }}
                            </div>
                            <div class="d-flex">
                                <div class="form-group passport">
                                    <label for="id_series_passport">{{ form.series_passport.label }}</label>
                                    {{ form.series_passport }}
                                    {{ form.series_passport.errors }}
                                </div>
                                <div class="form-group">
                                    <label for="id_num_passport">{{ form.num_passport.label }}</label>
                                    {{ form.num_passport }}
                                    {{ form.num_passport.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="id_email">{{ form.email.label }}</label>
                                {{ form.email }}
                                {{ form.email.errors }}
                            </div>
                            <div class="form-group checkbox">
                                {{ form.check_box }}
                                <label class="fake_checkbox" for="id_check_box">
                                    <img src="{% static 'icon/check.svg' %}">
                                </label>
                                <span class="label"> Я согласен на <a href="#">обработку персональных данных</a></span>
                            </div>
                            <div class="form-group">
                                <label for="id_phone">{{ form.phone.label }}</label>
                                {{ form.phone }}
                                {{ form.phone.errors }}
                            </div>

                            {% if step == 'send_sms' %}
                            <button class="btn btn_grd btn_send_sms btn_sms" name="code">
                                Отправить код
                            </button>
                            {% else %}
                            <div>
                                <div class="form-group">
                                    <label for="id_code">Введите код</label>
                                    {{ form.code }}
                                    {{ form.code.errors }}
                                </div>
                                <div class="code_1">
                                    <button class="btn_new_code a" name="code">
                                        Отправить код повторно
                                    </button>
                                    <span>через <span id="timer">{{ time_sms }}</span> секунд</span>
                                </div>
                            </div>
                            <button class="btn btn_grd btn_check_code" name="docx">
                                Сформировать договор
                            </button>
                            {% endif %}
                        </div>
                    </div>
                    <div aria-labelledby="nav-2-tab" class="tab-pane fade {% if step == 'docx' %}show active{% endif %}" id="nav-2"
                         role="tabpanel">
                        <p class="step">Шаг 2/4. Договор</p>
                        <div class="treaty">
                            <div class="treaty_1">
                                {{ docx_base | safe }}
                            </div>
                            <button class="btn btn_grd btn_wizard_100" id="acceptButton" type="button">Принимаю условия
                                договора
                            </button>
                        </div>
                    </div>
                    <div aria-labelledby="nav-3-tab" class="tab-pane fade" id="nav-3" role="tabpanel">
                        <p class="step">Шаг 3/4. Подпись</p>
                        <div class="signature">
                            <h2>Поставьте свою подпись, используя сенсорный ввод</h2>
                            <div class="signature_1 d-flex justify-content-center align-items-center">
                                <canvas height="430" id="paint" width="343"></canvas>
                                <input id="sign" name="sign" type="hidden">
                                <button id="clearCanvas" type="button">Стереть</button>
                            </div>
                            <button class="btn btn_grd btn_wizard_100" id="signContract" name="qr_code">
                                Подписать договор
                            </button>
                        </div>
                    </div>
                    <div aria-labelledby="nav-4-tab" class="tab-pane fade {% if step == 'qr_code' %}show active{% endif %}" id="nav-4" role="tabpanel">
                        <p class="step">Шаг 4/4. Получение счета</p>
                        <div class="qr_code">
                            <h2>Договор отправлен на указанную вами почту.</h2>
                            <p>Оплатить счет вы можете в течение 5 рабочих дней по данному QR-коду (полная версия счета
                                отправлена на почту).</p>
                            <span>До встречи в Клубе Первых!</span>
                            <img src="data:application/octet-stream;base64,{{ img_base }}" width="248" />
                        </div>

                        <a download="qrcode" href="data:image/png;base64,{{ img_base }}"
                           class="btn btn_grd btn_wizard_100">
                            Скачать QR-код для оплаты
                        </a>
                    </div>
                    <div aria-labelledby="nav-5-tab" class="tab-pane fade" id="nav-5" role="tabpanel">
                        <p class="step">Все этапы заполнены</p>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<input name="csrfmiddlewaretoken" type="hidden" value="{{ csrf_token }}">
<script src="{% static 'js/fabric.min.js' %}"></script>
<script src="{% static 'js/app.js' %}"></script>
<script>

</script>
</body>
</html>
